<Page x:Class="Verko_Shoes.ProductPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Verko_Shoes"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800"
      Title="ProductPage" FontFamily="Times New Roman">

    <Page.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="45"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="40"/>
        </Grid.RowDefinitions>

        <WrapPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
            <TextBlock Text="Поиск:" VerticalAlignment="Center" Margin="5"/>
            <TextBox Name="TBSearch" TextChanged="TBSearch_TextChanged" Width="160" Height="25" Margin="5,0"/>

            <ComboBox Name="ComboType" SelectionChanged="ComboType_SelectionChanged" FontSize="14" Width="200" Height="25" VerticalAlignment="Center" Margin="5,0">
                <ComboBoxItem>Все поставщики</ComboBoxItem>
                <ComboBoxItem>Kari</ComboBoxItem>
                <ComboBoxItem>Обувь для вас</ComboBoxItem>
            </ComboBox>

            <StackPanel Orientation="Vertical" Margin="5">
                <RadioButton Content="По возрастанию количества на складе" GroupName="Sort" FontSize="14" Name="RButtonUp" Checked="RButtonUp_Checked" VerticalAlignment="Center"/>
                <RadioButton Content="По убыванию количества на складе" GroupName="Sort" FontSize="14" Name="RButtonDown" Checked="RButtonDown_Checked" VerticalAlignment="Center"/>
            </StackPanel>
        </WrapPanel>

        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Left" Margin="5">
            <TextBlock Text="Вы авторизированы как " VerticalAlignment="Center"/>
            <TextBlock Name="FOITB" VerticalAlignment="Center" Margin="5,0,10,0"/>
            <TextBlock Text="Роль: " VerticalAlignment="Center"/>
            <TextBlock Name="RoleTB" VerticalAlignment="Center" Margin="5,0"/>
        </StackPanel>

        <ListView Name="ProductList" Grid.Row="2">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="350"/>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition Width="120"/>
                        </Grid.ColumnDefinitions>

                        <Image Width="180" Height="120" Grid.Column="0" Stretch="UniformToFill" Margin="10">
                            <Image.Source>
                                <Binding Path="ProductPhoto">
                                    <Binding.TargetNullValue>
                                        <ImageSource>ress/picture.png</ImageSource>
                                    </Binding.TargetNullValue>
                                </Binding>
                            </Image.Source>
                        </Image>

                        <StackPanel Grid.Column="1" Margin="10">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="{Binding ProductCategory.ProductCategoryName}" FontSize="18" FontWeight="Bold"/>
                                <TextBlock Text=" | " FontSize="18" FontWeight="Bold"/>
                                <TextBlock Text="{Binding ProductName}" FontSize="18" FontWeight="Bold" TextWrapping="Wrap"/>
                            </StackPanel>

                            <TextBlock Text="{Binding ProductDescription, StringFormat='Описание товара: {0}'}" FontSize="14" TextWrapping="Wrap" Margin="0,2,0,0"/>
                            <TextBlock Text="{Binding ProductManufacturer, StringFormat='Производитель: {0}'}" FontSize="14" Margin="0,2,0,0"/>
                            <TextBlock Text="{Binding ProductSupplier, StringFormat='Поставщик: {0}'}" FontSize="14" Margin="0,2,0,0"/>

                            <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                <TextBlock Text="Цена: " FontSize="14"/>
                                <TextBlock Text="{Binding ProductPrice}" FontSize="14" TextDecorations="Strikethrough" Margin="5,0,5,0" Foreground="Red"/>
                                <TextBlock Text="{Binding NewCost}" FontSize="14"/>
                            </StackPanel>

                            <TextBlock Text="{Binding ProductUnitOfMeasurment, StringFormat='Единица измерения: {0}'}" FontSize="14" Margin="0,2,0,0"/>
                            <TextBlock Text="{Binding ProductCountInStock, StringFormat='Количество на складе: {0:0}'}" FontSize="14" Margin="0,2,0,0">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ProductCountInStock}" Value="0">
                                                <Setter Property="Background" Value="LightBlue"/>
                                                <Setter Property="Foreground" Value="Black"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>

                        <TextBlock Text="{Binding ProductCurrentDiscount, StringFormat={}{0}%}" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center" Grid.Column="2"/>

                        <StackPanel Grid.Column="3" VerticalAlignment="Center">
                            <Button Content="Редактировать" 
                                    Visibility="{Binding RelativeSource={RelativeSource AncestorType=Page}, Path=IsUsersAuthorized, Converter={StaticResource BoolToVis}}"
                                    Name="EditButton" Click="EditButton_Click" Width="110" Height="25" Margin="0,0,0,5"/>
                            <Button Content="Удалить" 
                                    Visibility="{Binding RelativeSource={RelativeSource AncestorType=Page}, Path=IsUsersAuthorized, Converter={StaticResource BoolToVis}}"
                                    Name="DeleteButton" Click="DeleteButton_Click" Width="110" Height="25"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <Button Name="AddButton" Click="AddButton_Click" Grid.Row="3" Content="Добавить" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,10"/>
    </Grid>
</Page>